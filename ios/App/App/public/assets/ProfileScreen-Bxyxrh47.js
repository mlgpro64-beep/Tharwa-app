import{a as Y,r as u,e as H,q as I,j as e,m as d,A as te,X as V,d as se,P as we,l as he,U as ge,c as F,C as X,M as ae,k as ke,u as Ce,b as ne,g as le,n as Se}from"./index-CzK-Wtpj.js";import{u as _}from"./useQuery-B1e_qTp-.js";import{S as Q}from"./animated-ifqYnJC-.js";import{A as de,a as ce,b as me}from"./avatar-CPrQWbpQ.js";import{P as Te}from"./ProfessionalBadge-PnLml-PX.js";import{u as B}from"./useMutation-BXgiM4Zs.js";import{B as R}from"./button-D95I_TH1.js";import{t as U,c as J,s as ue,f as E,a as fe,e as be}from"./ar-C0KQNq9O.js";import{C as ye}from"./chevron-left-CHJaYFut.js";import{C as ie}from"./chevron-right-MByHq59g.js";import{C as De}from"./check-BpdMCCzI.js";import{T as Me,N as Pe,P as qe}from"./trash-2-Ce2Bgf6u.js";import{F as z}from"./FloatingInput-Q9Q65xjP.js";import{D as Z}from"./DateTimePicker-CTkTbxoK.js";import{T as Ae}from"./schema-CbH_BfFp.js";import{L as G}from"./loader-circle-AYqjcifH.js";import{S as re}from"./send-9v2j9KhO.js";import{T as Fe}from"./tag-DcG1YM2n.js";import{F as je}from"./file-text-ZpwEK5vc.js";import{C as W}from"./calendar-CAGmnp_J.js";import{C as oe}from"./circle-check-big-BUMRiSQy.js";import{S as Le}from"./star-CdLY6qwL.js";import{A as Ee}from"./arrow-left-eQXjCarb.js";import{S as Oe}from"./settings-wN2QqbeF.js";import{S as Re}from"./shield-Cglcz5iT.js";import{C as $e}from"./sun-BjJkm-rc.js";import"./utils-km2FGkQ4.js";import"./receipt-2PYmiGbT.js";import"./arrow-right-CPiXL_Yk.js";import"./award-Dy6u7LjK.js";import"./briefcase-CG3vAR-K.js";import"./camera-B3Gnq2Ue.js";import"./palette-Da5ZzNJ9.js";import"./user-check-6ccO8QVr.js";import"./chevron-down-DDOviN73.js";import"./circle-x-D3T454mR.js";import"./clipboard-list-B8-J9jf1.js";import"./dollar-sign-EFTHd7iI.js";import"./smartphone-CxZXcd48.js";import"./ellipsis-CWjK1vf2.js";import"./eye-off-D3AByt6D.js";import"./eye-yefYjQ94.js";import"./file-check-B-PxUlvl.js";import"./filter-CpO21OEq.js";import"./heart-BRsyov3V.js";import"./inbox-DejM70i8.js";import"./lock-B56TYpix.js";import"./log-in-KhGTY87V.js";import"./log-out-PQe0qTlg.js";import"./mail-DnD_Dbv3.js";import"./message-circle-BzmAey6U.js";import"./message-square--SMsGGZh.js";import"./phone-BU10rKK_.js";import"./refresh-cw-CP1D-P28.js";import"./search-x-C3PLNNx9.js";import"./sparkles-CAG2jcvH.js";import"./trending-up-BEW_fBut.js";import"./upload-CUoyT6Pu.js";import"./users-CYCByTGv.js";import"./wrench-Drh-fOGi.js";import"./zap-DFEP0yYU.js";import"./Modal-DGwTDYVd.js";function ee(p,c){const n=U(p);if(isNaN(c))return J(p,NaN);if(!c)return n;const h=n.getDate(),g=J(p,n.getTime());g.setMonth(n.getMonth()+c+1,0);const s=g.getDate();return h>=s?g:(n.setFullYear(g.getFullYear(),g.getMonth(),h),n)}function Ie(p){return J(p,Date.now())}function ve(p,c){const n=ue(p),h=ue(c);return+n==+h}function xe(p){const c=U(p),n=c.getMonth();return c.setFullYear(c.getFullYear(),n+1,0),c.setHours(23,59,59,999),c}function Ke(p,c){const n=U(p.start),h=U(p.end);let g=+n>+h;const s=g?+n:+h,i=g?h:n;i.setHours(0,0,0,0);let y=1;const w=[];for(;+i<=s;)w.push(U(i)),i.setDate(i.getDate()+y),i.setHours(0,0,0,0);return g?w.reverse():w}function pe(p){const c=U(p);return c.setDate(1),c.setHours(0,0,0,0),c}function Ue(p){return ve(p,Ie(p))}function ze(p,c){return ee(p,-c)}function He({userId:p,isEditable:c=!1,onDateSelect:n}){const{t:h,i18n:g}=Y(),s=g.language==="ar",i=s?fe:be,[y,w]=u.useState(new Date),[k,T]=u.useState(null),M=E(pe(y),"yyyy-MM-dd"),b=E(xe(ee(y,1)),"yyyy-MM-dd"),{data:N=[],isLoading:j}=_({queryKey:["/api/users",p,"availability",M,b],queryFn:()=>fetch(`/api/users/${p}/availability?startDate=${M}&endDate=${b}`).then(o=>o.json())}),m=B({mutationFn:async o=>H("/api/availability","POST",o),onSuccess:()=>{I.invalidateQueries({queryKey:["/api/users",p,"availability"]})}}),L=u.useMemo(()=>{const o=new Map;return N.forEach(v=>{o.set(v.date,v.status)}),o},[N]),f=u.useMemo(()=>{const o=pe(y),v=xe(y),P=Ke({start:o,end:v}),x=o.getDay();return[...Array(x).fill(null),...P]},[y]),q=s?["Ø£Ø­Ø¯","Ø§Ø«Ù†ÙŠÙ†","Ø«Ù„Ø§Ø«Ø§Ø¡","Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø®Ù…ÙŠØ³","Ø¬Ù…Ø¹Ø©","Ø³Ø¨Øª"]:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],C=()=>w(ze(y,1)),t=()=>w(ee(y,1)),a=o=>{if(c)T(o);else{const v=E(o,"yyyy-MM-dd"),P=l(o);n==null||n(v,P||"available")}},A=o=>{if(!k)return;const v=E(k,"yyyy-MM-dd");m.mutate({date:v,status:o}),n==null||n(v,o),T(null)},l=o=>{const v=E(o,"yyyy-MM-dd");return L.get(v)||null};return e.jsxs("div",{className:"bg-white/60 dark:bg-white/5 backdrop-blur-2xl rounded-3xl border border-white/20 dark:border-white/10 p-4 sm:p-6","data-testid":"calendar-availability",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(R,{variant:"ghost",size:"icon",onClick:C,className:"rounded-xl","data-testid":"button-prev-month",children:e.jsx(ye,{className:`w-5 h-5 ${s?"rotate-180":""}`})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:E(y,"MMMM yyyy",{locale:i})}),e.jsx(R,{variant:"ghost",size:"icon",onClick:t,className:"rounded-xl","data-testid":"button-next-month",children:e.jsx(ie,{className:`w-5 h-5 ${s?"rotate-180":""}`})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:q.map(o=>e.jsx("div",{className:"text-center text-xs font-medium text-gray-500 dark:text-gray-400 py-2",children:o},o))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:f.map((o,v)=>{if(!o)return e.jsx("div",{className:"aspect-square"},`empty-${v}`);const P=l(o),x=o<new Date(new Date().setHours(0,0,0,0)),D=k&&ve(o,k);return e.jsxs(d.button,{whileTap:c&&!x?{scale:.95}:void 0,onClick:()=>!x&&a(o),disabled:x,className:`
                aspect-square rounded-xl flex items-center justify-center text-sm font-medium
                transition-all duration-200 relative
                ${x?"opacity-40 cursor-not-allowed":"cursor-pointer"}
                ${D?"ring-2 ring-primary ring-offset-2":""}
                ${Ue(o)?"font-bold":""}
                ${P==="available"?"bg-green-500/20 text-green-700 dark:text-green-400 border border-green-500/30":P==="busy"?"bg-red-500/20 text-red-700 dark:text-red-400 border border-red-500/30":"hover:bg-gray-100 dark:hover:bg-white/10 text-gray-700 dark:text-gray-300"}
              `,"data-testid":`calendar-day-${E(o,"yyyy-MM-dd")}`,children:[E(o,"d"),P&&e.jsx("span",{className:`absolute bottom-1 left-1/2 -translate-x-1/2 w-1.5 h-1.5 rounded-full ${P==="available"?"bg-green-500":"bg-red-500"}`})]},o.toISOString())})}),e.jsx(te,{children:k&&c&&e.jsxs(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"mt-4 p-4 bg-gray-100/80 dark:bg-white/5 rounded-2xl backdrop-blur-md",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 text-center",children:E(k,"EEEE, d MMMM",{locale:i})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(R,{onClick:()=>A("available"),className:"flex-1 bg-green-500 hover:bg-green-600 text-white rounded-xl",disabled:m.isPending,"data-testid":"button-set-available",children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),h("availability.available","Available")]}),e.jsxs(R,{onClick:()=>A("busy"),className:"flex-1 bg-red-500 hover:bg-red-600 text-white rounded-xl",disabled:m.isPending,"data-testid":"button-set-busy",children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),h("availability.busy","Busy")]})]})]})}),e.jsxs("div",{className:"mt-4 flex items-center justify-center gap-6 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:h("availability.available","Available")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:h("availability.busy","Busy")})]})]})]})}function Be({userId:p,isEditable:c=!1}){const{t:n}=Y(),{toast:h}=se(),g=u.useRef(null),[s,i]=u.useState(null),[y,w]=u.useState(!1),[k,T]=u.useState(!1),M=6,{data:b=[],isLoading:N}=_({queryKey:["/api/users",p,"photos"],queryFn:()=>fetch(`/api/users/${p}/photos`).then(a=>a.json())}),j=B({mutationFn:async a=>H("/api/photos","POST",a),onSuccess:()=>{I.invalidateQueries({queryKey:["/api/users",p,"photos"]}),h({title:n("portfolio.photoAdded","Photo added"),description:n("portfolio.photoAddedDesc","Your photo has been added to your portfolio")})},onError:()=>{h({title:n("common.error","Error"),description:n("portfolio.uploadError","Failed to upload photo"),variant:"destructive"})}}),m=B({mutationFn:async a=>H(`/api/photos/${a}`,"DELETE"),onSuccess:()=>{I.invalidateQueries({queryKey:["/api/users",p,"photos"]}),i(null),h({title:n("portfolio.photoDeleted","Photo deleted")})}}),L=async a=>{var l;const A=(l=a.target.files)==null?void 0:l[0];if(A){if(A.size>5*1024*1024){h({title:n("common.error","Error"),description:n("portfolio.fileTooLarge","File size must be less than 5MB"),variant:"destructive"});return}w(!0);try{const o=new FileReader;o.onloadend=async()=>{const v=o.result;await j.mutateAsync({url:v}),w(!1)},o.readAsDataURL(A)}catch{w(!1)}g.current&&(g.current.value="")}},f=()=>{s!==null&&s>0&&i(s-1)},q=()=>{s!==null&&s<b.length-1&&i(s+1)};if(N)return e.jsx("div",{className:"grid grid-cols-3 gap-2","data-testid":"gallery-skeleton",children:[1,2,3].map(a=>e.jsx("div",{className:"aspect-square rounded-2xl bg-gray-200 dark:bg-gray-700 animate-pulse"},a))});if(b.length===0&&!c)return null;const C=k?b:b.slice(0,M),t=b.length>M;return e.jsxs("div",{"data-testid":"gallery-portfolio",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[C.map((a,A)=>e.jsxs(d.button,{layoutId:`photo-${a.id}`,onClick:()=>i(b.indexOf(a)),className:"aspect-square rounded-2xl overflow-hidden relative group",whileTap:{scale:.98},"data-testid":`gallery-photo-${a.id}`,children:[e.jsx("img",{src:a.url,alt:a.caption||"Portfolio photo",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors"})]},a.id)),c&&e.jsx(d.button,{onClick:()=>{var a;return(a=g.current)==null?void 0:a.click()},disabled:y,className:"aspect-square rounded-2xl border-2 border-dashed border-gray-300 dark:border-gray-600 flex flex-col items-center justify-center gap-2 text-gray-400 hover:border-primary hover:text-primary transition-colors",whileTap:{scale:.98},"data-testid":"button-add-photo",children:y?e.jsx("div",{className:"w-6 h-6 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-6 h-6"}),e.jsx("span",{className:"text-xs font-medium",children:n("portfolio.addPhoto","Add Photo")})]})})]}),t&&e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},className:"mt-3 text-center",children:e.jsx(R,{variant:"ghost",onClick:()=>T(!k),className:"text-primary font-semibold text-sm","data-testid":"button-view-all-photos",children:k?n("portfolio.showLess"):n("portfolio.viewAll",{count:b.length})})}),e.jsx("input",{ref:g,type:"file",accept:"image/*",onChange:L,className:"hidden","data-testid":"input-photo-upload"}),e.jsx(te,{children:s!==null&&e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/90 backdrop-blur-xl flex flex-col",onClick:()=>i(null),"data-testid":"lightbox-overlay",children:[e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs("span",{className:"text-white/60 text-sm",children:[s+1," / ",b.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[c&&e.jsx(R,{variant:"ghost",size:"icon",onClick:a=>{a.stopPropagation(),m.mutate(b[s].id)},className:"text-white hover:bg-white/10 rounded-xl","data-testid":"button-delete-photo",children:e.jsx(Me,{className:"w-5 h-5"})}),e.jsx(R,{variant:"ghost",size:"icon",onClick:()=>i(null),className:"text-white hover:bg-white/10 rounded-xl","data-testid":"button-close-lightbox",children:e.jsx(V,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex-1 flex items-center justify-center px-4 relative",onClick:a=>a.stopPropagation(),children:[s>0&&e.jsx(R,{variant:"ghost",size:"icon",onClick:a=>{a.stopPropagation(),f()},className:"absolute left-4 text-white hover:bg-white/10 rounded-xl z-10","data-testid":"button-prev-photo",children:e.jsx(ye,{className:"w-6 h-6"})}),e.jsx(d.img,{layoutId:`photo-${b[s].id}`,src:b[s].url,alt:b[s].caption||"Portfolio photo",className:"max-w-full max-h-[70vh] object-contain rounded-2xl",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9}},b[s].id),s<b.length-1&&e.jsx(R,{variant:"ghost",size:"icon",onClick:a=>{a.stopPropagation(),q()},className:"absolute right-4 text-white hover:bg-white/10 rounded-xl z-10","data-testid":"button-next-photo",children:e.jsx(ie,{className:"w-6 h-6"})})]}),b[s].caption&&e.jsx("div",{className:"p-4 text-center text-white/80",children:b[s].caption})]})})]})}const Ye=async(p,c)=>{try{const h=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${p}&lon=${c}&addressdetails=1`)).json();if(h.address){const{road:g,suburb:s,city:i,town:y,village:w,state:k,country:T}=h.address;return[g,s||w||y,i,k].filter(Boolean).slice(0,3).join(", ")||T||"Unknown Location"}return"Unknown Location"}catch{return"Unknown Location"}},Qe=u.memo(function({isOpen:c,onClose:n,tasker:h}){const{i18n:g}=Y(),s=g.language==="ar",{toast:i}=se(),[y,w]=u.useState(1),[k,T]=u.useState(!1),[M,b]=u.useState(!1),[N,j]=u.useState("idle"),[m,L]=u.useState({}),[f,q]=u.useState({category:"",title:"",description:"",scheduledDate:"",scheduledTime:"",location:"",latitude:null,longitude:null,budget:""}),C=B({mutationFn:async r=>H("POST","/api/direct-requests",{taskerId:h.id,...r,budget:parseFloat(r.budget)}),onSuccess:()=>{I.invalidateQueries({queryKey:["/api/direct-requests"]}),I.invalidateQueries({queryKey:["/api/notifications"]}),i({title:s?"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨!":"Request Sent!",description:s?"Ø³ÙŠØªÙ… Ø¥Ø®Ø·Ø§Ø±Ùƒ Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ±Ø¯ Ø§Ù„Ù…Ù†ÙØ°":"You will be notified when the tasker responds"}),t()},onError:r=>{i({title:s?"ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„":"Failed to send",description:r.message,variant:"destructive"})}}),t=u.useCallback(()=>{w(1),q({category:"",title:"",description:"",scheduledDate:"",scheduledTime:"",location:"",latitude:null,longitude:null,budget:""}),L({}),n()},[n]),a=u.useCallback((r,S)=>{q(K=>({...K,[r]:S})),m[r]&&L(K=>({...K,[r]:""}))},[m]),A=u.useCallback(()=>{if(!navigator.geolocation){j("error");return}j("loading"),navigator.geolocation.getCurrentPosition(async r=>{const{latitude:S,longitude:K}=r.coords,Ne=await Ye(S,K);a("location",Ne),a("latitude",S),a("longitude",K),j("success")},()=>{j("error")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},[a]),l=u.useCallback(r=>{const S={};return r===1?f.category||(S.category=s?"Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ":"Select a category"):r===2?(f.title.trim()||(S.title=s?"Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø·Ù„ÙˆØ¨":"Title is required"),f.description.trim()||(S.description=s?"Ø§Ù„ÙˆØµÙ Ù…Ø·Ù„ÙˆØ¨":"Description is required")):r===3&&(f.budget||(S.budget=s?"Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ù…Ø·Ù„ÙˆØ¨Ø©":"Budget is required"),f.location.trim()||(S.location=s?"Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ø·Ù„ÙˆØ¨":"Location is required"),f.scheduledDate||(S.scheduledDate=s?"Ø§Ù„ØªØ§Ø±ÙŠØ® Ù…Ø·Ù„ÙˆØ¨":"Date is required"),f.scheduledTime||(S.scheduledTime=s?"Ø§Ù„ÙˆÙ‚Øª Ù…Ø·Ù„ÙˆØ¨":"Time is required")),L(S),Object.keys(S).length===0},[f,s]),o=u.useCallback(()=>{l(y)&&w(r=>r+1)},[y,l]),v=u.useCallback(()=>{l(3)&&C.mutate(f)},[f,l,C]),P=Object.entries(Ae).map(([r,S])=>({id:r,name:s?S.nameAr:S.nameEn,color:S.colorHex,icon:S.icon})),x=()=>e.jsxs(d.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Fe,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-bold text-lg",children:s?"Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ":"Choose Category"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-[40vh] overflow-y-auto no-scrollbar py-2",children:P.map(r=>e.jsxs(d.button,{whileTap:{scale:.95},onClick:()=>a("category",r.id),"data-testid":`button-category-${r.id}`,className:F("p-4 rounded-2xl border-2 text-left transition-all",f.category===r.id?"border-primary bg-primary/10":"border-transparent bg-muted hover:bg-muted/80"),children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center mb-2",style:{backgroundColor:`${r.color}20`},children:e.jsx("span",{className:"text-xl",style:{color:r.color},children:r.icon==="sparkles"?"âœ¨":r.icon==="graduation-cap"?"ðŸŽ“":r.icon==="palette"?"ðŸŽ¨":r.icon==="hard-hat"?"ðŸ”¨":r.icon==="star"?"â­":"ðŸ“¦"})}),e.jsx("span",{className:"font-semibold text-sm block truncate",children:r.name})]},r.id))}),m.category&&e.jsx("p",{className:"text-destructive text-sm font-medium",children:m.category})]},"step1"),D=()=>e.jsxs(d.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(je,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-bold text-lg",children:s?"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø©":"Service Details"})]}),e.jsx(z,{label:s?"Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø¯Ù…Ø©":"Service Title",value:f.title,onChange:r=>a("title",r.target.value),error:m.title,"data-testid":"input-service-title"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:f.description,onChange:r=>a("description",r.target.value),placeholder:s?"ØµÙ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ Ø¨Ø§Ù„ØªÙØµÙŠÙ„...":"Describe what you need in detail...",className:F("w-full h-32 px-4 py-4 rounded-2xl border-2 bg-card shadow-sm outline-none transition-all resize-none font-medium",m.description?"border-destructive/50 focus:border-destructive":"border-transparent focus:border-primary/50"),"data-testid":"input-service-description"}),m.description&&e.jsx("p",{className:"text-destructive text-sm font-medium mt-1",children:m.description})]})]},"step2"),$=()=>e.jsxs(d.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(W,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-bold text-lg",children:s?"Ø§Ù„Ù…ÙˆØ¹Ø¯ ÙˆØ§Ù„Ù…ÙˆÙ‚Ø¹":"Schedule & Location"})]}),e.jsx(z,{label:s?"Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© (Ø±ÙŠØ§Ù„)":"Budget (SAR)",type:"number",value:f.budget,onChange:r=>a("budget",r.target.value),error:m.budget,"data-testid":"input-budget"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>T(!0),"data-testid":"button-select-date",className:F("h-16 px-4 rounded-2xl border-2 bg-card flex items-center gap-3 transition-all text-left",f.scheduledDate?"border-primary/50":"border-transparent",m.scheduledDate&&"border-destructive/50"),children:[e.jsx(W,{className:"w-5 h-5 text-muted-foreground"}),e.jsx("span",{className:F("text-sm font-medium truncate",f.scheduledDate?"text-foreground":"text-muted-foreground"),children:f.scheduledDate||(s?"Ø§Ù„ØªØ§Ø±ÙŠØ®":"Date")})]}),e.jsxs("button",{onClick:()=>b(!0),"data-testid":"button-select-time",className:F("h-16 px-4 rounded-2xl border-2 bg-card flex items-center gap-3 transition-all text-left",f.scheduledTime?"border-primary/50":"border-transparent",m.scheduledTime&&"border-destructive/50"),children:[e.jsx(X,{className:"w-5 h-5 text-muted-foreground"}),e.jsx("span",{className:F("text-sm font-medium truncate",f.scheduledTime?"text-foreground":"text-muted-foreground"),children:f.scheduledTime||(s?"Ø§Ù„ÙˆÙ‚Øª":"Time")})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{label:s?"Ø§Ù„Ù…ÙˆÙ‚Ø¹":"Location",value:f.location,onChange:r=>a("location",r.target.value),error:m.location,"data-testid":"input-location"}),e.jsx("button",{onClick:A,className:"absolute right-3 top-4 p-2 rounded-xl bg-primary/10 hover:bg-primary/20 transition-colors","data-testid":"button-get-location",children:N==="loading"?e.jsx(G,{className:"w-5 h-5 animate-spin text-primary"}):N==="success"?e.jsx(oe,{className:"w-5 h-5 text-success"}):e.jsx(ae,{className:"w-5 h-5 text-primary"})})]})]},"step3");return c?he.createPortal(e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end justify-center sm:items-center",children:[e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/50 backdrop-blur-md",onClick:t,"data-testid":"modal-backdrop"}),e.jsxs(d.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},className:"glass-premium w-full max-w-md rounded-t-[2.5rem] sm:rounded-[2.5rem] p-6 pb-safe shadow-2xl relative z-10","data-testid":"modal-direct-request",children:[e.jsx("div",{className:"w-12 h-1.5 bg-white/20 rounded-full mx-auto mb-4 sm:hidden"}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(ge,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-lg",children:s?"Ø·Ù„Ø¨ Ø®Ø¯Ù…Ø© Ù…Ù†":"Request Service from"}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:h.name})]})]}),e.jsx("button",{onClick:t,className:"p-2 rounded-full hover:bg-muted transition-colors","data-testid":"button-close-modal",children:e.jsx(V,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"flex items-center gap-2 mb-6",children:[1,2,3].map(r=>e.jsx("div",{className:F("h-1.5 flex-1 rounded-full transition-all",r<=y?"bg-primary":"bg-muted")},r))}),e.jsx("div",{className:"min-h-[280px]",children:e.jsxs(te,{mode:"wait",children:[y===1&&x(),y===2&&D(),y===3&&$()]})}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[y>1&&e.jsx("button",{onClick:()=>w(r=>r-1),className:"flex-1 h-14 bg-muted text-foreground rounded-2xl font-bold text-lg hover:bg-muted/80 transition-all","data-testid":"button-back",children:s?"Ø±Ø¬ÙˆØ¹":"Back"}),y<3?e.jsx("button",{onClick:o,className:"flex-1 h-14 bg-primary text-primary-foreground rounded-2xl font-bold text-lg hover:bg-primary/90 shadow-lg shadow-primary/25 transition-all","data-testid":"button-next",children:s?"Ø§Ù„ØªØ§Ù„ÙŠ":"Next"}):e.jsx("button",{onClick:v,disabled:C.isPending,className:"flex-1 h-14 bg-primary text-primary-foreground rounded-2xl font-bold text-lg hover:bg-primary/90 shadow-lg shadow-primary/25 transition-all disabled:opacity-50 flex items-center justify-center gap-2","data-testid":"button-submit-request",children:C.isPending?e.jsx(G,{className:"w-5 h-5 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-5 h-5"}),s?"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨":"Send Request"]})})]})]}),e.jsx(Z,{isOpen:k,onClose:()=>T(!1),onSelect:r=>a("scheduledDate",r),mode:"date",title:s?"Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®":"Select Date"}),e.jsx(Z,{isOpen:M,onClose:()=>b(!1),onSelect:r=>a("scheduledTime",r),mode:"time",title:s?"Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª":"Select Time"})]}),document.body):null}),_e=async(p,c)=>{try{const h=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${p}&lon=${c}&addressdetails=1`)).json();if(h.address){const{road:g,suburb:s,city:i,town:y,village:w,state:k,country:T}=h.address;return[g,s||w||y,i,k].filter(Boolean).slice(0,3).join(", ")||T||"Unknown Location"}return"Unknown Location"}catch{return"Unknown Location"}},Ge=u.memo(function({isOpen:c,onClose:n,tasker:h,selectedDate:g}){const{i18n:s}=Y(),i=s.language==="ar",y=i?fe:be,{toast:w}=se(),[k,T]=u.useState(!1),[M,b]=u.useState("idle"),[N,j]=u.useState({}),[m,L]=u.useState({title:"",description:"",scheduledTime:"",location:"",latitude:null,longitude:null}),f=B({mutationFn:async l=>H("POST","/api/direct-requests",{taskerId:h.id,title:l.title,description:l.description,scheduledDate:E(g,"yyyy-MM-dd"),scheduledTime:l.scheduledTime,location:l.location,latitude:l.latitude,longitude:l.longitude,budget:"0"}),onSuccess:()=>{I.invalidateQueries({queryKey:["/api/direct-requests"]}),I.invalidateQueries({queryKey:["/api/notifications"]}),w({title:i?"ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨!":"Request Sent!",description:i?"Ø³ÙŠØªÙ… Ø¥Ø®Ø·Ø§Ø±Ùƒ Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ±Ø¯ Ø§Ù„Ù…Ù†ÙØ°":"You will be notified when the tasker responds"}),q()},onError:l=>{w({title:i?"ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„":"Failed to send",description:l.message,variant:"destructive"})}}),q=u.useCallback(()=>{L({title:"",description:"",scheduledTime:"",location:"",latitude:null,longitude:null}),j({}),b("idle"),n()},[n]),C=u.useCallback((l,o)=>{L(v=>({...v,[l]:o})),N[l]&&j(v=>({...v,[l]:""}))},[N]),t=u.useCallback(()=>{if(!navigator.geolocation){b("error");return}b("loading"),navigator.geolocation.getCurrentPosition(async l=>{const{latitude:o,longitude:v}=l.coords,P=await _e(o,v);C("location",P),C("latitude",o),C("longitude",v),b("success")},()=>{b("error")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},[C]),a=u.useCallback(()=>{const l={};return m.title.trim()||(l.title=i?"Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù…Ø·Ù„ÙˆØ¨":"Title is required"),m.description.trim()||(l.description=i?"Ø§Ù„ÙˆØµÙ Ù…Ø·Ù„ÙˆØ¨":"Description is required"),m.scheduledTime||(l.scheduledTime=i?"Ø§Ù„ÙˆÙ‚Øª Ù…Ø·Ù„ÙˆØ¨":"Time is required"),m.location.trim()||(l.location=i?"Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ø·Ù„ÙˆØ¨":"Location is required"),j(l),Object.keys(l).length===0},[m,i]),A=u.useCallback(()=>{a()&&f.mutate(m)},[m,a,f]);return c?he.createPortal(e.jsxs("div",{className:"fixed inset-0 z-50 flex items-end justify-center sm:items-center",children:[e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/50 backdrop-blur-md",onClick:q,"data-testid":"modal-backdrop"}),e.jsxs(d.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},className:"glass-premium w-full max-w-md rounded-t-[2.5rem] sm:rounded-[2.5rem] p-6 pb-safe shadow-2xl relative z-10 max-h-[90vh] overflow-y-auto","data-testid":"modal-date-task",children:[e.jsx("div",{className:"w-12 h-1.5 bg-white/20 rounded-full mx-auto mb-4 sm:hidden"}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(W,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-lg",children:i?"Ø·Ù„Ø¨ Ø®Ø¯Ù…Ø©":"Request Service"}),e.jsx("p",{className:"text-sm text-muted-foreground font-medium",children:E(g,"EEEE, d MMMM yyyy",{locale:y})})]})]}),e.jsx("button",{onClick:q,className:"p-2 rounded-full hover:bg-muted transition-colors","data-testid":"button-close-modal",children:e.jsx(V,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(X,{className:"w-5 h-5 text-primary"}),e.jsx("label",{className:"text-sm font-semibold text-foreground",children:i?"Ø§Ù„ÙˆÙ‚Øª":"Time"})]}),e.jsxs("button",{onClick:()=>T(!0),"data-testid":"button-select-time",className:F("w-full h-14 px-4 rounded-2xl border-2 bg-card flex items-center gap-3 transition-all text-left",m.scheduledTime?"border-primary/50":"border-transparent",N.scheduledTime&&"border-destructive/50"),children:[e.jsx(X,{className:"w-5 h-5 text-muted-foreground"}),e.jsx("span",{className:F("text-sm font-medium",m.scheduledTime?"text-foreground":"text-muted-foreground"),children:m.scheduledTime||(i?"Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª":"Select Time")})]}),N.scheduledTime&&e.jsx("p",{className:"text-destructive text-sm font-medium mt-1",children:N.scheduledTime})]}),e.jsx("div",{children:e.jsx(z,{label:i?"Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø·Ù„Ø¨":"Task Title",value:m.title,onChange:l=>C("title",l.target.value),error:N.title,"data-testid":"input-task-title",placeholder:i?"Ù…Ø«Ø§Ù„: ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ù†Ø²Ù„":"Example: House Cleaning"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(je,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("label",{className:"text-sm font-semibold text-foreground",children:i?"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨":"Task Details"})]}),e.jsx("textarea",{value:m.description,onChange:l=>C("description",l.target.value),placeholder:i?"ØµÙ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ Ø¨Ø§Ù„ØªÙØµÙŠÙ„...":"Describe what you need in detail...",className:F("w-full h-32 px-4 py-4 rounded-2xl border-2 bg-card shadow-sm outline-none transition-all resize-none font-medium",N.description?"border-destructive/50 focus:border-destructive":"border-transparent focus:border-primary/50"),"data-testid":"input-task-description"}),N.description&&e.jsx("p",{className:"text-destructive text-sm font-medium mt-1",children:N.description})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ae,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("label",{className:"text-sm font-semibold text-foreground",children:i?"Ø§Ù„Ù…ÙˆÙ‚Ø¹":"Location"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{label:i?"Ø§Ù„Ù…ÙˆÙ‚Ø¹":"Location",value:m.location,onChange:l=>C("location",l.target.value),error:N.location,"data-testid":"input-location",placeholder:i?"Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ":"Enter address or use current location"}),e.jsx("button",{onClick:t,className:"absolute right-3 top-4 p-2 rounded-xl bg-primary/10 hover:bg-primary/20 transition-colors","data-testid":"button-get-location",children:M==="loading"?e.jsx(G,{className:"w-5 h-5 animate-spin text-primary"}):M==="success"?e.jsx(oe,{className:"w-5 h-5 text-success"}):e.jsx(Pe,{className:"w-5 h-5 text-primary"})})]}),N.location&&e.jsx("p",{className:"text-destructive text-sm font-medium mt-1",children:N.location})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:q,className:"flex-1 h-14 bg-muted text-foreground rounded-2xl font-bold text-lg hover:bg-muted/80 transition-all","data-testid":"button-cancel",children:i?"Ø¥Ù„ØºØ§Ø¡":"Cancel"}),e.jsx("button",{onClick:A,disabled:f.isPending,className:"flex-1 h-14 bg-primary text-primary-foreground rounded-2xl font-bold text-lg hover:bg-primary/90 shadow-lg shadow-primary/25 transition-all disabled:opacity-50 flex items-center justify-center gap-2","data-testid":"button-submit-request",children:f.isPending?e.jsx(G,{className:"w-5 h-5 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-5 h-5"}),i?"Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨":"Send Request"]})})]})]}),e.jsx(Z,{isOpen:k,onClose:()=>T(!1),onSelect:l=>C("scheduledTime",l),mode:"time",title:i?"Ø§Ø®ØªØ± Ø§Ù„ÙˆÙ‚Øª":"Select Time"})]}),document.body):null}),We={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.06,delayChildren:.1}}},O={hidden:{opacity:0,y:16},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:24}}},is=u.memo(function(){const{userId:c}=ke(),[,n]=Ce(),{user:h,userRole:g}=ne(),{t:s,i18n:i}=Y(),[y,w]=u.useState(!1),[k,T]=u.useState(!1),[M,b]=u.useState(null),N=i.language==="ar",j=!c,{data:m,isLoading:L}=_({queryKey:["/api/users/me"],queryFn:async()=>{const x=await fetch("/api/users/me",{credentials:"include"});if(!x.ok){if(x.status===401)return console.log("[Profile] Not authenticated, status:",x.status),null;throw new Error("Failed to fetch user")}const D=await x.json();return console.log("[Profile] Fetched user data:",{id:D.id,name:D.name,username:D.username}),D},enabled:j,retry:!1,refetchOnWindowFocus:!0,refetchOnMount:!0}),{data:f,isLoading:q}=_({queryKey:["/api/users",c],queryFn:async()=>{const x=await fetch(`/api/users/${c}`,{credentials:"include"});if(!x.ok)throw new Error("User not found");return x.json()},enabled:!!c&&!j}),C=j?L:q,t=j?m||h:f,a=(t==null?void 0:t.role)==="tasker",A=!!(m||h),{setUser:l}=ne();u.useEffect(()=>{j&&m&&m!==h&&l(m)},[j,m,h,l]);const o=u.useCallback(x=>x.split(" ").map(D=>D[0]).join("").toUpperCase().slice(0,2),[]),v=u.useMemo(()=>[{labelKey:"profile.rating",value:t!=null&&t.rating?parseFloat(String(t.rating)).toFixed(1):"0.0",icon:Le,color:"text-warning",bgColor:"bg-gradient-to-br from-warning/20 to-warning/5"},{labelKey:"profile.tasksCompleted",value:(t==null?void 0:t.completedTasks)||0,icon:oe,color:"text-success",bgColor:"bg-gradient-to-br from-success/20 to-success/5"},{labelKey:"profile.memberSince",value:t!=null&&t.createdAt?new Date(t.createdAt).getFullYear():new Date().getFullYear(),icon:W,color:"text-primary",bgColor:"bg-gradient-to-br from-primary/20 to-primary/5"}],[t]),P=u.useMemo(()=>[{icon:ge,labelKey:"profile.editProfile",path:"/profile/edit",testId:"button-edit-profile-full"},{icon:Se,labelKey:g==="tasker"?"tasks.assignedTasks":"tasks.myTasks",path:"/my-tasks",testId:"button-my-tasks"},{icon:$e,labelKey:"settings.help",path:"/help",testId:"button-help"}],[g]);return C?e.jsxs("div",{className:"min-h-screen gradient-mesh pt-safe px-5 py-5",children:[e.jsx("div",{className:"flex items-center justify-center mb-8",children:e.jsx(Q,{className:"w-28 h-28 rounded-full"})}),e.jsx(Q,{className:"h-8 w-48 mx-auto mb-2 rounded-lg"}),e.jsx(Q,{className:"h-4 w-32 mx-auto mb-6 rounded-lg"}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-8",children:[1,2,3].map(x=>e.jsx(Q,{className:"h-28 rounded-2xl"},x))})]}):j&&!A?e.jsx("div",{className:"min-h-screen gradient-mesh pt-safe px-5 py-5 flex flex-col items-center justify-center",children:e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-4",children:N?"ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„":"Please Login"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:N?"ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¹Ø±Ø¶ Ù…Ù„ÙÙƒ Ø§Ù„Ø´Ø®ØµÙŠ":"You need to login to view your profile"}),e.jsx(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>n("/login"),className:"px-6 py-3 gradient-primary text-white rounded-2xl font-bold",children:N?"ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„":"Login"})]})}):e.jsxs("div",{className:"min-h-screen gradient-mesh pt-safe pb-32",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx(d.div,{initial:{opacity:0,scale:.8},animate:{opacity:.4,scale:1},transition:{duration:1},className:"absolute top-20 -right-24 w-72 h-72 bg-gradient-to-br from-accent/25 to-accent/5 rounded-full blur-3xl rtl:-left-24 rtl:right-auto"}),e.jsx(d.div,{initial:{opacity:0},animate:{opacity:.25},transition:{delay:.3},className:"absolute bottom-60 -left-16 w-48 h-48 bg-gradient-to-tr from-primary/20 to-transparent rounded-full blur-3xl rtl:-right-16 rtl:left-auto"})]}),e.jsxs(d.div,{variants:We,initial:"hidden",animate:"visible",className:"relative z-10 px-5 py-5",children:[e.jsxs(d.div,{variants:O,className:"flex items-center justify-between mb-6",children:[j?e.jsx("div",{className:"w-11"}):e.jsx(d.button,{whileHover:{scale:1.05},whileTap:{scale:.92},onClick:()=>window.history.back(),className:"w-11 h-11 flex items-center justify-center rounded-2xl glass","data-testid":"button-back",children:e.jsx(Ee,{className:"w-5 h-5 text-foreground/80 rtl:rotate-180"})}),e.jsx("h1",{className:"text-xl font-bold text-foreground",children:s(j?"profile.title":"profile.myProfile")}),j?e.jsx(d.button,{whileHover:{scale:1.05},whileTap:{scale:.92},onClick:()=>n("/settings"),className:"w-11 h-11 flex items-center justify-center rounded-2xl glass","data-testid":"button-settings",children:e.jsx(Oe,{className:"w-5 h-5 text-foreground/80"})}):e.jsx("div",{className:"w-11"})]}),e.jsxs(d.div,{variants:O,className:"flex flex-col items-center mb-7",children:[e.jsx("div",{className:"relative mb-5",children:j?e.jsx(le,{href:"/profile/edit",children:e.jsxs(d.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:20},className:"relative cursor-pointer",whileHover:{scale:1.05},whileTap:{scale:.95},children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-br from-primary/40 to-accent/40 rounded-full blur-md"}),e.jsxs(de,{className:"relative w-28 h-28 border-4 border-white/50 dark:border-white/20 shadow-2xl",children:[e.jsx(ce,{src:(t==null?void 0:t.avatar)||void 0,alt:t==null?void 0:t.name}),e.jsx(me,{className:"gradient-primary text-white text-3xl font-bold",children:t!=null&&t.name?o(t.name):"U"})]}),e.jsx(d.div,{whileHover:{scale:1.1,rotate:5},whileTap:{scale:.9},className:"absolute -bottom-1 -right-1 w-10 h-10 gradient-primary text-white rounded-2xl flex items-center justify-center shadow-lg shadow-primary/30 border-2 border-white/50 rtl:-left-1 rtl:right-auto z-10","data-testid":"button-edit-profile",children:e.jsx(qe,{className:"w-4 h-4"})})]})}):e.jsxs(d.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:20},className:"relative",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-br from-primary/40 to-accent/40 rounded-full blur-md"}),e.jsxs(de,{className:"relative w-28 h-28 border-4 border-white/50 dark:border-white/20 shadow-2xl",children:[e.jsx(ce,{src:(t==null?void 0:t.avatar)||void 0,alt:t==null?void 0:t.name}),e.jsx(me,{className:"gradient-primary text-white text-3xl font-bold",children:t!=null&&t.name?o(t.name):"U"})]})]})}),e.jsx("h2",{className:"text-2xl font-extrabold text-foreground mb-1 tracking-tight",children:(t==null?void 0:t.name)||s("common.guest")}),e.jsxs("p",{className:"text-muted-foreground text-sm mb-4",children:["@",(t==null?void 0:t.username)||"guest"]}),e.jsxs(d.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},className:F("flex items-center gap-2 px-4 py-2 rounded-full text-xs font-bold uppercase tracking-wider mb-3",g==="tasker"?"bg-success/15 text-success":"bg-primary/15 text-primary"),children:[e.jsx(Re,{className:"w-3.5 h-3.5"}),s(g==="tasker"?"roles.tasker":"roles.client")]}),t&&"professionalRoles"in t&&t.professionalRoles&&t.professionalRoles.length>0&&e.jsx(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.25},children:e.jsx(Te,{roles:t.professionalRoles,size:"md",maxDisplay:4})})]}),e.jsx(d.div,{variants:O,className:"grid grid-cols-3 gap-3 mb-6",children:v.map((x,D)=>{const $=x.icon;return e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.25+D*.05},className:"glass rounded-[20px] p-4 text-center",children:[e.jsx("div",{className:F("w-9 h-9 rounded-xl mx-auto mb-2.5 flex items-center justify-center",x.bgColor),children:e.jsx($,{className:F("w-4 h-4",x.color)})}),e.jsx("p",{className:"text-xl font-extrabold text-foreground",children:x.value}),e.jsx("p",{className:"text-[10px] text-muted-foreground font-semibold uppercase tracking-wider mt-0.5",children:s(x.labelKey)})]},x.labelKey)})}),(t==null?void 0:t.bio)&&e.jsxs(d.div,{variants:O,className:"glass rounded-[20px] p-5 mb-4",children:[e.jsx("h3",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-wider mb-2.5",children:s("profile.about")}),e.jsx("p",{className:"text-foreground leading-relaxed text-sm",children:t.bio})]}),(t==null?void 0:t.location)&&e.jsx(d.div,{variants:O,className:"glass rounded-[20px] p-4 mb-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center",children:e.jsx(ae,{className:"w-5 h-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-muted-foreground font-semibold uppercase tracking-wider",children:s("tasks.location")}),e.jsx("p",{className:"font-bold text-foreground",children:t.location})]})]})}),!j&&a&&g==="client"&&e.jsx(d.div,{variants:O,className:"mb-5",children:e.jsxs(d.button,{whileHover:{scale:1.01},whileTap:{scale:.98},onClick:()=>w(!0),className:"w-full h-14 gradient-primary text-white rounded-2xl font-bold text-lg shadow-lg shadow-primary/25 flex items-center justify-center gap-3","data-testid":"button-request-service",children:[e.jsx(re,{className:"w-5 h-5"}),N?"Ø§Ø·Ù„Ø¨ Ø®Ø¯Ù…Ø© Ù…Ø¨Ø§Ø´Ø±Ø©":"Request Direct Service"]})}),a&&(t==null?void 0:t.id)&&e.jsxs(d.div,{variants:O,className:"mb-5",children:[e.jsx("h3",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-wider px-1 mb-3",children:s("portfolio.title","Portfolio")}),e.jsx(Be,{userId:t.id,isEditable:j})]}),a&&(t==null?void 0:t.id)&&e.jsxs(d.div,{variants:O,className:"mb-5",children:[e.jsx("h3",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-wider px-1 mb-3",children:s("availability.title","Availability")}),e.jsx(He,{userId:t.id,isEditable:j,onDateSelect:(x,D)=>{if(!j&&g==="client"){const $=new Date(x+"T00:00:00");b($),T(!0)}}})]}),j&&e.jsxs(d.div,{variants:O,className:"space-y-2.5",children:[e.jsx("p",{className:"text-[10px] font-bold text-muted-foreground uppercase tracking-wider px-1 mb-2",children:s("wallet.quickActions")}),P.map((x,D)=>{const $=x.icon;return e.jsx(d.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.45+D*.05},children:e.jsx(le,{href:x.path,children:e.jsxs(d.button,{whileHover:{x:4},whileTap:{scale:.98},className:"w-full glass rounded-[18px] font-semibold flex items-center justify-between p-4","data-testid":x.testId,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-xl bg-gradient-to-br from-primary/15 to-primary/5 flex items-center justify-center",children:e.jsx($,{className:"w-4 h-4 text-primary"})}),e.jsx("span",{className:"text-foreground text-sm",children:s(x.labelKey)})]}),e.jsx(ie,{className:"w-4 h-4 text-muted-foreground rtl:rotate-180"})]})})},x.testId)})]})]}),t&&!j&&a&&e.jsxs(e.Fragment,{children:[e.jsx(Qe,{isOpen:y,onClose:()=>w(!1),tasker:t}),M&&e.jsx(Ge,{isOpen:k,onClose:()=>{T(!1),b(null)},tasker:t,selectedDate:M})]})]})});export{is as default};
