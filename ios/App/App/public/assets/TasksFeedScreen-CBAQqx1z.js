import{r as o,u as k,a as T,j as e,m as a,S as A,A as g,X as f,c as y}from"./index-CzK-Wtpj.js";import{T as E}from"./TaskCard-a_kB6T9e.js";import{u as L}from"./useQuery-B1e_qTp-.js";import{T as $,E as F}from"./animated-ifqYnJC-.js";import{g as H,T as Q}from"./schema-CbH_BfFp.js";import{F as _}from"./filter-CpO21OEq.js";import{S as z}from"./search-x-C3PLNNx9.js";import"./currency-BA8TA7a2.js";import"./heart-BRsyov3V.js";import"./dollar-sign-EFTHd7iI.js";import"./chevron-right-MByHq59g.js";import"./utils-km2FGkQ4.js";const b={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.06,delayChildren:.1}}},d={hidden:{opacity:0,y:16},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:24}}},J=o.memo(function(){k();const{t:r,i18n:v}=T(),j=v.language==="ar",[s,x]=o.useState(null),[n,m]=o.useState(""),w=!!localStorage.getItem("userId"),{data:c,isLoading:C}=L({queryKey:["/api/tasks/available",s],enabled:w}),u=o.useMemo(()=>(c==null?void 0:c.filter(t=>{if(!s)return!0;const i=H(t.category),p=(i==null?void 0:i.mainCategory)===s,l=!n||t.title.toLowerCase().includes(n.toLowerCase())||t.description.toLowerCase().includes(n.toLowerCase());return p&&l}))||[],[c,s,n]),h=o.useCallback(t=>{x(t)},[]),N=o.useCallback(()=>{m("")},[]),S=u.length;return e.jsxs("div",{className:"min-h-screen gradient-mesh pt-safe pb-32",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx(a.div,{initial:{opacity:0,scale:.8},animate:{opacity:.4,scale:1},transition:{duration:1},className:"absolute top-32 -left-24 w-72 h-72 bg-gradient-to-br from-accent/25 to-accent/5 rounded-full blur-3xl rtl:-right-24 rtl:left-auto"}),e.jsx(a.div,{initial:{opacity:0},animate:{opacity:.25},transition:{duration:1.2,delay:.3},className:"absolute bottom-60 -right-16 w-48 h-48 bg-gradient-to-tl from-primary/20 to-transparent rounded-full blur-3xl rtl:-left-16 rtl:right-auto"})]}),e.jsxs(a.div,{variants:b,initial:"hidden",animate:"visible",className:"relative z-10 px-5 py-5",children:[e.jsx(a.div,{variants:d,className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-extrabold text-foreground tracking-tight",children:r("tasks.feed")}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-0.5",children:[S," ",r("tasks.available")]})]})}),e.jsxs(a.div,{variants:d,className:"relative mb-5",children:[e.jsx(A,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground rtl:right-4 rtl:left-auto"}),e.jsx("input",{type:"search",placeholder:`${r("common.search")}...`,value:n,onChange:t=>m(t.target.value),className:"w-full h-13 ps-12 pe-12 rounded-2xl glass-input text-foreground placeholder:text-muted-foreground focus:outline-none transition-all text-base","data-testid":"input-search-tasks"}),e.jsx(g,{children:n&&e.jsx(a.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},onClick:N,className:"absolute right-4 top-1/2 -translate-y-1/2 w-7 h-7 flex items-center justify-center rounded-full bg-muted/80 hover:bg-muted transition-colors rtl:left-4 rtl:right-auto",children:e.jsx(f,{className:"w-3.5 h-3.5 text-muted-foreground"})})})]}),e.jsxs(a.div,{variants:d,className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(_,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:r("tasks.category")})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto no-scrollbar pb-1 -mx-5 px-5",children:[e.jsx(a.button,{whileTap:{scale:.95},onClick:()=>h(null),"data-testid":"button-category-all",className:y("px-4 py-2.5 rounded-xl font-semibold text-sm whitespace-nowrap transition-all duration-200",s===null?"gradient-primary text-white shadow-lg shadow-primary/25":"glass text-muted-foreground hover:text-foreground"),children:r("tasks.filters.allCategories")}),Object.entries(Q).map(([t,i])=>{const p=j?i.nameAr:i.nameEn,l=i.colorHex||"#6B7280";return e.jsx(a.button,{whileTap:{scale:.95},onClick:()=>h(t),"data-testid":`button-filter-${t}`,className:y("px-4 py-2.5 rounded-xl font-semibold text-sm whitespace-nowrap transition-all duration-200",s===t?"text-white shadow-lg":"glass text-muted-foreground hover:text-foreground"),style:{background:s===t?`linear-gradient(135deg, ${l} 0%, ${l}CC 100%)`:void 0,boxShadow:s===t?`0 8px 20px -8px ${l}60`:void 0},children:p},t)})]})]})]}),e.jsx("div",{className:"relative z-10 px-5",children:e.jsx(g,{mode:"wait",children:C?e.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx($,{count:4})},"loading"):u.length>0?e.jsx(a.div,{variants:b,initial:"hidden",animate:"visible",className:"space-y-3",children:u.map((t,i)=>e.jsx(a.div,{variants:d,children:e.jsx(E,{task:t,index:i})},t.id))},"tasks"):e.jsx(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:e.jsx(F,{icon:e.jsx(z,{className:"w-8 h-8"}),title:r("tasks.empty.title"),description:r("tasks.empty.description"),action:(n||s)&&e.jsxs(a.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>{m(""),x(null)},className:"glass-premium text-foreground px-6 py-3 rounded-2xl font-bold flex items-center gap-2",children:[e.jsx(f,{className:"w-4 h-4"}),r("common.filter")]})})},"empty")})})]})});export{J as default};
