import{r as c,j as e,m as a,c as d,A as N,u as L,a as I,b as P,d as q,X as S,e as B,q as E,C as M}from"./index-CzK-Wtpj.js";import{u as X}from"./useMutation-BXgiM4Zs.js";import{C as v}from"./check-BpdMCCzI.js";import{A as $}from"./arrow-left-eQXjCarb.js";import{U as H}from"./upload-CUoyT6Pu.js";import{F as T}from"./file-check-B-PxUlvl.js";import{L as Y}from"./loader-circle-AYqjcifH.js";import{C as Z}from"./chevron-left-CHJaYFut.js";import{B as C}from"./briefcase-CG3vAR-K.js";import{A}from"./award-Dy6u7LjK.js";import{S as D}from"./shield-Cglcz5iT.js";import{Z as J}from"./zap-DFEP0yYU.js";import"./utils-km2FGkQ4.js";const O=[{id:"general",titleKey:"taskerType.general.title",subtitleKey:"taskerType.general.subtitle",icon:C,featuresKeys:["taskerType.general.features.anyTask","taskerType.general.features.noCertificate","taskerType.general.features.immediateActivation"],gradient:"from-emerald-500 to-teal-500",badgeKey:"taskerType.general.badge",badgeColor:"bg-emerald-500/20 text-emerald-600 dark:text-emerald-400"},{id:"specialized",titleKey:"taskerType.specialized.title",subtitleKey:"taskerType.specialized.subtitle",icon:A,featuresKeys:["taskerType.specialized.features.professional","taskerType.specialized.features.uploadCertificate","taskerType.specialized.features.pendingReview"],gradient:"from-amber-500 to-orange-500",badgeKey:"taskerType.specialized.badge",badgeColor:"bg-amber-500/20 text-amber-600 dark:text-amber-400"}],Q={"taskerType.general.features.anyTask":C,"taskerType.general.features.noCertificate":D,"taskerType.general.features.immediateActivation":J,"taskerType.specialized.features.professional":A,"taskerType.specialized.features.uploadCertificate":T,"taskerType.specialized.features.pendingReview":M},G=c.memo(function({option:s,isSelected:r,onSelect:h,t:m}){const g=s.icon;return e.jsx(a.button,{layout:!0,onClick:h,whileTap:{scale:.98},className:d("w-full text-start p-6 rounded-3xl transition-all duration-300 relative overflow-hidden",r?"glass-premium shadow-xl border-2 border-primary":"glass hover:shadow-lg border-2 border-transparent"),"data-testid":`button-tasker-type-${s.id}`,children:e.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[e.jsx(a.div,{animate:{scale:r?1.05:1,rotate:r?5:0},className:d("w-14 h-14 rounded-2xl flex items-center justify-center transition-all shadow-lg",r?`bg-gradient-to-br ${s.gradient} text-white shadow-lg`:"bg-muted/50 text-muted-foreground"),children:e.jsx(g,{className:"w-7 h-7"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("h3",{className:"text-xl font-bold text-foreground",children:m(s.titleKey)}),e.jsx("span",{className:d("px-2 py-0.5 rounded-full text-xs font-semibold",s.badgeColor),children:m(s.badgeKey)})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:m(s.subtitleKey)}),e.jsx(N,{children:r&&e.jsx(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-3 overflow-hidden",children:s.featuresKeys.map((n,o)=>{const i=Q[n]||v;return e.jsxs(a.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:o*.1},className:"flex items-center gap-3 text-sm text-foreground/80 rtl:flex-row-reverse rtl:text-right",children:[e.jsx("div",{className:d("w-6 h-6 rounded-full flex items-center justify-center shrink-0",r&&s.id==="general"?"bg-emerald-500/20":"bg-amber-500/20"),children:e.jsx(i,{className:d("w-3.5 h-3.5",r&&s.id==="general"?"text-emerald-600 dark:text-emerald-400":"text-amber-600 dark:text-amber-400")})}),e.jsx("span",{className:"flex-1",children:m(n)})]},n)})})})]}),e.jsx(a.div,{animate:{scale:r?1:.8,opacity:r?1:.5},className:d("w-7 h-7 rounded-full flex items-center justify-center transition-all",r?"bg-primary text-white shadow-lg shadow-primary/30":"border-2 border-muted"),children:r&&e.jsx(a.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500},children:e.jsx(v,{className:"w-4 h-4"})})})]})})}),de=c.memo(function(){const[,s]=L(),{t:r,i18n:h}=I(),{user:m,setUser:g,isAuthenticated:n}=P(),{toast:o}=q(),i=h.language==="ar",[l,K]=c.useState(null),[u,w]=c.useState(!1),[f,b]=c.useState(null),y=c.useRef(null),p=X({mutationFn:async t=>(await B("POST","/api/users/apply-tasker",t)).json(),onSuccess:t=>{g(t.user),E.invalidateQueries({queryKey:["/api/users/me"]}),o({title:i?"تم استلام طلبك":"Application Received",description:i?"سيتم مراجعة طلبك وإشعارك بالنتيجة":"Your application is under review"}),s("/settings")},onError:t=>{o({title:i?"حدث خطأ":"Error",description:t.message,variant:"destructive"})}}),R=c.useCallback(t=>{var k;const x=(k=t.target.files)==null?void 0:k[0];if(!x)return;if(x.size>5*1024*1024){o({title:i?"الملف كبير جداً":"File too large",description:i?"يجب أن يكون حجم الملف أقل من 5 ميجابايت":"File must be less than 5MB",variant:"destructive"});return}const j=new FileReader;j.onload=()=>{b(j.result)},j.readAsDataURL(x)},[o,i]),F=c.useCallback(()=>{if(l)if(n&&m)if(l==="specialized"){if(!u){w(!0);return}if(!f){o({title:i?"مطلوب شهادة":"Certificate Required",description:i?"يرجى رفع شهادتك المهنية":"Please upload your professional certificate",variant:"destructive"});return}p.mutate({taskerType:l,certificateUrl:f})}else p.mutate({taskerType:l});else s(`/register?taskerType=${l}`)},[l,n,m,u,f,s,p,o,i]),U=c.useCallback(()=>{u?(w(!1),b(null)):s(n?"/settings":"/role")},[u,n,s]);return e.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-b from-background to-primary/5 pt-safe",children:[e.jsxs(a.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between px-6 py-4",children:[e.jsx(a.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:U,className:"w-11 h-11 flex items-center justify-center rounded-2xl glass","data-testid":"button-back",children:e.jsx($,{className:"w-5 h-5 rtl:rotate-180"})}),e.jsx("div",{className:"flex gap-2",children:[0,1,2].map(t=>e.jsx(a.div,{initial:{scaleX:0},animate:{scaleX:1},transition:{delay:t*.1},className:d("w-10 h-1.5 rounded-full transition-colors",t<=1?"bg-primary":"bg-muted")},t))}),e.jsx("div",{className:"w-11"})]}),e.jsxs("div",{className:"flex-1 flex flex-col px-6 py-8",children:[e.jsx(N,{mode:"wait",children:u?e.jsxs(a.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"flex-1 flex flex-col",children:[e.jsx("h1",{className:"text-3xl font-extrabold text-foreground tracking-tight mb-2",children:i?"رفع الشهادة":"Upload Certificate"}),e.jsx("p",{className:"text-muted-foreground text-lg mb-8",children:i?"ارفع شهادتك المهنية للتحقق":"Upload your professional certificate for verification"}),e.jsx("input",{ref:y,type:"file",accept:"image/*",onChange:R,className:"hidden"}),f?e.jsxs("div",{className:"relative glass rounded-3xl p-4 mb-6",children:[e.jsx("img",{src:f,alt:"Certificate",className:"w-full h-64 object-cover rounded-2xl"}),e.jsx(a.button,{whileTap:{scale:.95},onClick:()=>{b(null),y.current&&(y.current.value="")},className:"absolute top-6 right-6 w-10 h-10 rounded-full bg-destructive/90 text-white flex items-center justify-center",children:e.jsx(S,{className:"w-5 h-5"})})]}):e.jsxs(a.button,{whileTap:{scale:.98},onClick:()=>{var t;return(t=y.current)==null?void 0:t.click()},className:"glass rounded-3xl p-8 flex flex-col items-center justify-center gap-4 mb-6 border-2 border-dashed border-primary/30",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(H,{className:"w-8 h-8 text-primary"})}),e.jsx("p",{className:"text-muted-foreground text-center",children:i?"اضغط لرفع الشهادة":"Click to upload certificate"})]}),e.jsx("div",{className:"glass rounded-2xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(T,{className:"w-5 h-5 text-primary flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-muted-foreground text-start",children:i?"سيتم مراجعة شهادتك من قبل فريقنا خلال 24-48 ساعة":"Your certificate will be reviewed by our team within 24-48 hours"})]})})]},"certificate-upload"):e.jsxs(a.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"flex-1 flex flex-col",children:[e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("h1",{className:"text-3xl font-extrabold text-foreground tracking-tight mb-2",children:n?i?"انضم كمنفذ":"Join as Tasker":r("taskerType.title")}),e.jsx("p",{className:"text-muted-foreground text-lg",children:r("taskerType.subtitle")})]}),e.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"space-y-4 mt-8 flex-1",children:O.map((t,x)=>e.jsx(a.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+x*.1},children:e.jsx(G,{option:t,isSelected:l===t.id,onSelect:()=>K(t.id),t:r})},t.id))})]},"type-selection")}),e.jsx(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"mt-6 pb-safe",children:e.jsx(a.button,{whileHover:{scale:l?1.02:1},whileTap:{scale:l?.98:1},onClick:F,disabled:!l||p.isPending,className:d("w-full h-14 rounded-2xl font-bold text-lg transition-all flex items-center justify-center gap-2",l&&!p.isPending?"gradient-primary text-white shadow-xl shadow-primary/25":"bg-muted text-muted-foreground cursor-not-allowed"),"data-testid":"button-continue",children:p.isPending?e.jsx(Y,{className:"w-5 h-5 animate-spin"}):e.jsxs(e.Fragment,{children:[u?i?"إرسال الطلب":"Submit Application":r("common.next"),e.jsx(Z,{className:"w-5 h-5 rtl:rotate-180"})]})})})]})]})});export{de as default};
